<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SportX - Exclusive Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #00d2ff;
            --secondary: #3a7bd5;
            --dark: #0f172a;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            background: #0f172a;
            color: white;
            overflow-x: hidden;
        }

        nav {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(15px);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border);
        }

        .logo { font-size: 24px; font-weight: 700; color: var(--primary); }

        .container { padding: 20px; }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
        }

        /* প্রোডাক্ট কার্ড */
        .p-card {
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 20px;
            overflow: hidden;
            transition: 0.3s;
            cursor: pointer;
        }

        .p-card:hover { transform: translateY(-8px); border-color: var(--primary); }

        .p-card img { width: 100%; height: 180px; object-fit: cover; }
        .p-details { padding: 15px; }
        .p-name { font-size: 15px; font-weight: 600; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .p-price { color: var(--primary); font-size: 17px; font-weight: bold; }

        /* ডিটেইলস মোডাল (Modal) */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-content {
            background: #1e293b;
            width: 100%;
            max-width: 500px;
            border-radius: 25px;
            overflow: hidden;
            position: relative;
            animation: slideUp 0.4s ease;
            border: 1px solid var(--border);
        }

        .modal-img { width: 100%; height: 250px; object-fit: cover; }
        .modal-body { padding: 25px; }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 25px; cursor: pointer; color: white; z-index: 10; }

        .btn-action {
            width: 100%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white; border: none; padding: 15px;
            border-radius: 12px; font-weight: 600; cursor: pointer; margin-top: 20px;
        }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        @media (max-width: 480px) {
            .product-grid { grid-template-columns: 1fr 1fr; gap: 12px; }
            .p-card img { height: 140px; }
        }
    </style>
</head>
<body>

<nav>
    <div class="logo">SportX</div>
    <div style="color:var(--primary); font-size: 14px;"><i class="fa fa-user"></i> Shop Live</div>
</nav>

<div class="container">
    <h2 style="font-weight: 400; margin-bottom: 25px;">New <span style="color:var(--primary)">Arrivals</span></h2>
    <div class="product-grid" id="product-display">
        </div>
</div>

<div class="modal" id="productModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <img id="m-img" class="modal-img" src="">
        <div class="modal-body">
            <h2 id="m-name" style="margin:0; color:var(--primary);"></h2>
            <p id="m-price" style="font-size: 20px; font-weight: bold; margin: 10px 0;"></p>
            <p id="m-desc" style="color: #94a3b8; font-size: 14px; line-height: 1.6;"></p>
            <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; font-size: 13px;">
                <i class="fa fa-box"></i> স্টক আছে: <span id="m-stock"></span> পিস
            </div>
            <button class="btn-action" onclick="orderNow()">অর্ডার করুন (Cash on Delivery)</button>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCu8lgGs3Q-qLeedhngQAVXtt8BHOAlWDg",
        authDomain: "ms-sp-97f78.firebaseapp.com",
        databaseURL: "https://ms-sp-97f78-default-rtdb.firebaseio.com",
        projectId: "ms-sp-97f78",
        storageBucket: "ms-sp-97f78.appspot.com",
        messagingSenderId: "880638162029",
        appId: "1:880638162029:web:b99af5b5518b3e16a13b64"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let allProducts = {};

    // --- প্রোডাক্ট লোড ও ডিসপ্লে ---
    onValue(ref(db, 'products'), (snapshot) => {
        const display = document.getElementById('product-display');
        display.innerHTML = "";
        
        if(snapshot.exists()) {
            allProducts = snapshot.val();
            Object.keys(allProducts).forEach(key => {
                const p = allProducts[key];
                display.innerHTML += `
                    <div class="p-card" onclick="openDetails('${key}')">
                        <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
                        <div class="p-details">
                            <div class="p-name">${p.name}</div>
                            <div class="p-price">${p.price} ৳</div>
                        </div>
                    </div>
                `;
            });
        }
    });

    // --- মোডাল ফাংশন ---
    window.openDetails = (id) => {
        const p = allProducts[id];
        document.getElementById('m-img').src = p.img;
        document.getElementById('m-name').innerText = p.name;
        document.getElementById('m-price').innerText = p.price + " ৳";
        document.getElementById('m-desc').innerText = p.description || "কোনো বর্ণনা নেই।";
        document.getElementById('m-stock').innerText = p.stock || "0";
        document.getElementById('productModal').style.display = 'flex';
    };

    window.closeModal = () => {
        document.getElementById('productModal').style.display = 'none';
    };

    window.orderNow = () => {
        const name = document.getElementById('m-name').innerText;
        alert(name + " অর্ডার করার জন্য আপনাকে অর্ডার পেজে পাঠানো হচ্ছে...");
        window.location.href = "order_confirm.html?product=" + encodeURIComponent(name);
    };

    // বাইরে ক্লিক করলে মোডাল বন্ধ হওয়া
    window.onclick = (event) => {
        if (event.target == document.getElementById('productModal')) closeModal();
    };

</script>
</body>
</html>
